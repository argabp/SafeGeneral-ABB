@using Kendo.Mvc.UI
@using Kendo.Mvc.TagHelpers
@using Microsoft.Extensions.Configuration
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@addTagHelper *, Kendo.Mvc

@inject IConfiguration Configuration

@{
    Layout = "~/Modules/Shared/_Layout.cshtml";
    ViewData["Title"] = "Laporan Buku Besar";
}

<script src="~/Modules/LaporanBukuBesar/JS/LaporanBukuBesar.index.js"></script>

<style>
    /* Gunakan Style yang sama dengan Jurnal Harian agar konsisten */
    .filter-section { display: flex; align-items: center; margin-bottom: 15px; }
    .filter-label { font-weight: bold; width: 140px; min-width: 140px; white-space: nowrap; margin-right: 15px; }
    .filter-input-group { display: flex; align-items: center; gap: 10px; }
    .sd-text { font-weight: 600; margin: 0 5px; }
</style>

<nav aria-label="breadcrumb">
   <ol class="breadcrumb" style="background: white;">
        <li class="breadcrumb-item"><a href="#">Accounting</a></li>
        <li class="breadcrumb-item active" aria-current="page">Laporan Buku Besar</li>
    </ol>
</nav>

<div class="flat-box filter-box">
<div class="flat-box-title ">
       Laporan Buku Besar
       </div>
    <div class="flat-box-content filter-container">
        
        <div class="filter-section">
            <label class="filter-label">Kode Cabang :</label>
            <input class="k-textbox" value="@ViewBag.UserCabangText" readonly style="width:300px; background-color: #e9ecef;" />
             <input type="hidden" id="KodeCabang" value="@ViewBag.UserCabangValue" />
        </div>

        <div class="filter-section">
            <label class="filter-label">Periode :</label>
            <div class="filter-input-group">
                @(Html.Kendo().DatePicker().Name("tgl1").Format("dd-MM-yyyy").HtmlAttributes(new { style = "width:120px;" }))
                <span class="sd-text">s/d</span>
                @(Html.Kendo().DatePicker().Name("tgl2").Format("dd-MM-yyyy").HtmlAttributes(new { style = "width:120px;" }))
            </div>
        </div>

       <div class="filter-section">
            <label class="filter-label">Kode Akun :</label>
            <div class="filter-input-group">
                @(Html.Kendo().ComboBox()
                    .Name("AkunAwal")
                    .Placeholder("Ketik kode/nama akun...")
                    .DataTextField("Display")
                    .DataValueField("Kode")
                    .Filter(FilterType.Contains)
                    .MinLength(2) // Cari setelah 2 karakter
                    .AutoBind(false) // Jangan load saat awal buka
                    .Suggest(true)
                    .HtmlAttributes(new { style = "width:250px;" })
                    .DataSource(source => { 
                        source.Read(read => { 
                            read.Action("GetCoaList", "LaporanBukuBesar"); 
                        })
                        .ServerFiltering(true); // Aktifkan filter di server
                    })
                )

                <span class="sd-text">s/d</span>

                @(Html.Kendo().ComboBox()
                    .Name("AkunAkhir")
                    .Placeholder("Ketik kode/nama akun...")
                    .DataTextField("Display")
                    .DataValueField("Kode")
                    .Filter(FilterType.Contains)
                    .MinLength(2)
                    .AutoBind(false)
                    .Suggest(true)
                    .HtmlAttributes(new { style = "width:250px;" })
                    .DataSource(source => { 
                        source.Read(read => { 
                            read.Action("GetCoaList", "LaporanBukuBesar"); 
                        })
                        .ServerFiltering(true);
                    })
                )
            </div>
        </div>

        <div class="filter-section">
            @(Html.Kendo().Button()
                .Name("btnSearch")
                .Content("<span class='k-icon k-i-search'></span> Cari")
                .HtmlAttributes(new { @class = "k-primary", style = "border-radius:6px; width:120px;" })
                .Events(e => e.Click("onSearchClick")) // <--- Pastikan ini memanggil onSearchClick
            )
        </div>

    </div>
</div>
