@using Kendo.Mvc.UI
@using Kendo.Mvc.TagHelpers
@using ABB.Application.JurnalMemorials104.Queries 
@using Microsoft.Extensions.Configuration
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@addTagHelper *, Kendo.Mvc

@inject IConfiguration Configuration

@{
    Layout = "~/Modules/Shared/_Layout.cshtml";
    ViewData["Title"] = "Jurnal Memorial 104";
}

<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="~/Modules/JurnalMemorial104/JS/JurnalMemorial104.index.js"></script>

<style>
    .div-box { padding-bottom: 1em; }
    .swal2-container { z-index: 10050 !important; }
     .breadcrumb-item + .breadcrumb-item::before {
        content: ">"; 
        padding: 0 .5rem; 
    }
</style>

<nav aria-label="breadcrumb">
   <ol class="breadcrumb" style="background: white; ">
        <li class="breadcrumb-item"><a href="#">Accounting</a></li>
        <li class="breadcrumb-item active" aria-current="page">Jurnal Memorial 104</li>
    </ol>
</nav>

<div class="flat-box">
    <div class="flat-box-title ">
       Jurnal Memorial 104
        <div class="pullright-flex">
            <input type="text" class="search-field-top " id="SearchKeyword" placeholder="Search No Voucher/Keterangan..."/>
            <button class="flat-btn-primary" onclick="btnAddJurnalMamorial104_OnClick()">Entri Jurnal Baru</button>
        </div>
    </div>

    <div class="flat-box-content">
        @(Html.Kendo().Grid<JurnalMemorial104Dto>()
            .Name("JurnalMemorial104Grid")
            .Events(e => e.DataBound("onGridDataBound"))
            .DataSource(dataSource => dataSource.Ajax()
                .Read(read => read.Action("GetJurnalMemorial104", "JurnalMemorial104").Data("getSearchFilter"))
                .PageSize(20)
            )
            .Columns(columns =>
            {
                columns.Bound(col => col.KodeCabang).Width(100).Title("Cabang");
                columns.Bound(col => col.NoVoucher).Width(180).Title("No. Voucher");
                columns.Bound(col => col.Tanggal).Format("{0:dd-MM-yyyy}").Width(120).Title("Tanggal");
                columns.Bound(col => col.Keterangan).Width(350).Title("Keterangan");
                columns.Bound(col => col.FlagGL).Title("Posting").Width(100)
                    .ClientTemplate("#= FlagGL ? '<i class=\"fa fa-check text-success\"></i> Yes' : '<i class=\"fa fa-times text-danger\"></i> No' #")
                    .HtmlAttributes(new { style = "text-align: center;" });
                
                columns.Command(command =>
                {
                   command.Custom("EditJurnal")
                       .Text(" Edit")
                        .IconClass("fa fa-edit")
                        .Click("btnEditJurnalMemorial104_OnClick");

                   command.Custom("DeleteJurnal")
                        .Text(" Hapus")
                        .IconClass("fa fa-trash")
                        .Click("onDeleteHeaderJurnalMemorial104_Click");
                        
                }).Width(220).Title("Action").Locked(true);
            })
            .Pageable(pager => pager.Refresh(true).PageSizes(true))
            .Sortable()
            .Filterable()
            .Scrollable()
            .Height(500)
            .Resizable(a=>a.Columns(true))
        )
    </div>
</div>

@(Html.Kendo().Window()
    .Name("JurnalMemorial104Window")
    .Title("Entri Jurnal Memorial 104")
    .Width(1100)
    .Modal(true)
    .Visible(false)
    .Draggable(true)
    .Actions(actions => actions.Close())
)

<script>
    function getSearchFilter() {
        return {
            searchKeyword: $("#SearchKeyword").val()
        };
    }

    $(document).ready(function () {
        $("#SearchKeyword").on("keyup", function() {
            $("#JurnalMemorial104Grid").data("kendoGrid").dataSource.read();
        });
    });

    function onGridDataBound(e) {
        var grid = e.sender;
        grid.resize(); // Pastikan layout rapi
    }
</script>