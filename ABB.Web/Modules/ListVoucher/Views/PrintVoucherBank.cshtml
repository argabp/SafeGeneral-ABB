@model ABB.Web.Modules.ListVoucher.Models.ListVoucherViewModel

@{
    // Ambil data pertama dari daftar voucher untuk info bank
    var infoBank = Model.VoucherList?.FirstOrDefault();
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Listing Bank</title>
    <link rel="stylesheet" href="~/css/paper.css" />
    <style>
        @@page { size: A4; margin: 20mm; }
        body { font-family: "Segoe UI", Arial, sans-serif; font-size: 12px; }
        h2 { text-align: center; margin-bottom: 10px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #000; padding: 6px; text-align: left; }
        th { background: #f2f2f2; }
        .total { text-align: right; font-weight: bold; }
        .no-border td { border: none !important; }
    </style>
</head>

<body class="A4">
<section class="sheet padding-10mm">
    <h2>Listing Bank</h2>

    <center>
        <p>
            <strong>Tanggal :</strong>
            @Model.TanggalAwal.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("id-ID")).ToLower()
            -
            @Model.TanggalAkhir.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("id-ID")).ToLower()
        </p>
        <h3>Voucher Bank - (@infoBank?.KodeBank) @infoBank?.KeteranganKasBank</h3>
    </center>

    <table>
        <thead>
            <tr>
                <th>No Voucher</th>
                <th>Nilai Debet</th>
                <th>Nilai Kredit</th>
                <th>Diterima dari / Dibayarkan Kepada</th>
                <th>Keterangan</th>
            </tr>
        </thead>
        <tbody>
        <tr>
            <td colspan = "5" style="font-weight:bold;" >Saldo Awal Rp. @infoBank?.Saldo?.ToString("N2")</td>
        </tr>
            @{
                decimal totalDebet = 0;
                decimal totalKredit = 0;
                decimal saldoAwal = infoBank?.Saldo ?? 0;

                foreach (var v in Model.VoucherList)
                {
                    <tr>
                        <td>@v.NoVoucher</td>
                        <td>
                            @if (v.DebetKredit == "D")
                            {
                                @( (v.TotalDalamRupiah ?? 0).ToString("N0") )
                                totalDebet += (v.TotalDalamRupiah ?? 0);
                            }
                        </td>
                        <td>
                            @if (v.DebetKredit == "K")
                            {
                                @( (v.TotalDalamRupiah ?? 0).ToString("N0") )
                                totalKredit += (v.TotalDalamRupiah ?? 0);
                            }
                        </td>
                        <td>@v.DiterimaDari</td>
                        <td>@v.KeteranganVoucher</td>
                    </tr>
                }
                 decimal saldoAkhir = saldoAwal + totalDebet - totalKredit;
            }
        </tbody>

        <tfoot>
            <tr style="font-weight:bold;">
                <td style="text-align:right;">Total</td>
                <td>@totalDebet.ToString("N0")</td>
                <td>@totalKredit.ToString("N0")</td>
                <td colspan="2"></td>
            </tr>
            <tr>
                <td style="font-weight:bold;" colspan ="5">Saldo Akhir Rp. @saldoAkhir.ToString("N2")</td>
            </tr>
        </tfoot>
    </table>
</section>
</body>
</html>
