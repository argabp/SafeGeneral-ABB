@using Kendo.Mvc.UI
@using Kendo.Mvc.TagHelpers
@using ABB.Application.InquiryNotaProduksis.Queries
@using Microsoft.Extensions.Configuration
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@addTagHelper *, Kendo.Mvc

@inject IConfiguration Configuration

@{
    Layout = "~/Modules/Shared/_Layout.cshtml";
    ViewData["Title"] = "Laporan Outstanding";
}

<script src="~/Modules/LaporanOutstanding/JS/LaporanOutstanding.index.js"></script>

<style>
    .filter-section {
        display: flex;
        align-items: center;
        gap: 15px; /* Jarak antar elemen sedikit diperlebar */
        margin-bottom: 10px;
        /* flex-wrap: wrap; <-- Dihilangkan atau diganti agar tidak berantakan di layar kecil */
    }

    .filter-label {
        font-weight: bold;
        /* width: 90px; <-- Ini penyebabnya, 90px terlalu kecil */
        min-width: 170px;    /* Gunakan min-width agar menyesuaikan teks yang panjang */
        white-space: nowrap; /* Mencegah teks turun ke bawah atau terpotong */
    }

    .filter-container {
        padding: 15px;
    }

    .breadcrumb-item + .breadcrumb-item::before {
        content: ">"; 
        padding: 0 .5rem; 
    }
</style>

<nav  aria-label="breadcrumb">
   <ol class="breadcrumb" style="background: white; ">
        <li class="breadcrumb-item"><a href="#">Finance</a></li>
        <li class="breadcrumb-item active" aria-current="page">Laporan Outstanding</li>
    </ol>
    </nav>

<div class="flat-box filter-box">
    <div class="flat-box-content filter-container">
    <label>DATA PRODUKSI</label><hr>
        <!-- Baris 1: Lokasi -->
        <div class="filter-section">
            <label class="filter-label" for="KodeCabang">Lokasi :</label>
            @(Html.Kendo().ComboBox()
                .Name("KodeCabang")
                .Placeholder("Pilih Cabang ...")
                .DataTextField("nm_cb")
                .DataValueField("kd_cb")
                .Filter("contains")
                .Suggest(true)
                .HtmlAttributes(new { style = "width:300px;" })
                .Template("#: kd_cb # - #: nm_cb #")
                .DataSource(source => {
                    source.Read(read => {
                        read.Action("GetKodeCabang", "LaporanOutstanding");
                    });
                })
                .AutoBind(true)
                .Enable(false)
                .Value(ViewBag.UserCabangValue) 
                .Text(ViewBag.UserCabangText)   
            )
        </div>

        <div class="filter-section">
            <div style="margin-bottom: 10px;">
                @(Html.Kendo().RadioButton()
                    .Name("JenisTransaksi")
                    .Value("Piutang")
                    .Label("Piutang")
                    .HtmlAttributes(new { id = "JenisTransaksi_Piutang" }) // Tambahkan ID untuk referensi JS
                )

                @(Html.Kendo().RadioButton()
                    .Name("JenisTransaksi")
                    .Value("Hutang")
                    .Label("Hutang")
                    .HtmlAttributes(new { id = "JenisTransaksi_Hutang" }) // Tambahkan ID untuk referensi JS
                )
            </div>

           <div id="checkboxContainerPiutang" style="padding: 10px; background-color: #e0ffe0; border: 1px solid #c0ffc0; display: none;">
                <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                    <!-- BARIS 1 -->
                    <div style="width: 23%;">
                        @(Html.Kendo().CheckBox().Name("Check_A1").Label("A1 - PREMI POS SENDIRI"))
                    </div>
                    <div style="width: 23%;">
                        @(Html.Kendo().CheckBox().Name("Check_B1").Label("B1 - PREMI REAS MASUK TTY"))
                    </div>
                    <div style="width: 23%;">
                        @(Html.Kendo().CheckBox().Name("Check_C1").Label("C1 - KLAIM REAS KELUAR TTY"))
                    </div>
                    <div style="width: 23%;">
                        @(Html.Kendo().CheckBox().Name("Check_K1").Label("K1 - PREMI AKDA"))
                    </div>

                    <!-- BARIS 2 -->
                    <div style="width: 23%;">
                        @(Html.Kendo().CheckBox().Name("Check_A2").Label("A2 - PREMI KOAS MASUK"))
                    </div>
                    <div style="width: 23%;">
                        @(Html.Kendo().CheckBox().Name("Check_B2").Label("B2 - PREMI REAS MASUK NON TTY"))
                    </div>
                    <div style="width: 23%;">
                        @(Html.Kendo().CheckBox().Name("Check_C2").Label("C2 - KLAIM REAS KELUAR NON TTY"))
                    </div>
                    <div style="width: 23%;">
                        @(Html.Kendo().CheckBox().Name("Check_K2").Label("K2 - PREMI AKDP"))
                    </div>

                    <!-- BARIS 3 (Ada Spacer agar K4 tetap di kolom 4) -->
                    <div style="width: 23%;">
                        @(Html.Kendo().CheckBox().Name("Check_A3").Label("A3 - KLAIM KOAS KELUAR"))
                    </div>
                    <div style="width: 23%;"></div> <!-- Spacer Kolom B -->
                    <div style="width: 23%;"></div> <!-- Spacer Kolom C -->
                    <div style="width: 23%;">
                        @(Html.Kendo().CheckBox().Name("Check_K4").Label("K4 - PREMI ASIBHARA"))
                    </div>

                    <!-- BARIS 4 (Spacer agar K5 tetap di kolom 4) -->
                    <div style="width: 23%;"></div> <!-- Spacer Kolom A -->
                    <div style="width: 23%;"></div> <!-- Spacer Kolom B -->
                    <div style="width: 23%;"></div> <!-- Spacer Kolom C -->
                    <div style="width: 23%;">
                        @(Html.Kendo().CheckBox().Name("Check_K5").Label("K5 - PREMI AKDA EXTRA"))
                    </div>
                </div>
            </div>

            <!-- CONTAINER HUTANG (NEW) -->
            <!-- Menggunakan warna background sedikit berbeda (misal merah muda pudar) untuk membedakan atau tetap hijau jika diinginkan -->
            <div id="checkboxContainerHutang" style="padding: 10px; background-color: #ffe0e0; border: 1px solid #ffc0c0; display:none;">
                <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                    <!-- BARIS 1 (A1 | B1 | C1) -->
                    <!-- A1 -->
                    <div style="width: 32%;">
                        @(Html.Kendo().CheckBox()
                            .Name("Check_H_A1")
                            .Label("A1 - KLAIM POS SENDIRI")
                        )
                    </div>

                    <!-- B1 -->
                    <div style="width: 32%;">
                        @(Html.Kendo().CheckBox()
                            .Name("Check_H_B1")
                            .Label("B1 - KLAIM REASURANSI MASUK TTY")
                        )
                    </div>

                    <!-- C1 -->
                    <div style="width: 32%;">
                        @(Html.Kendo().CheckBox()
                            .Name("Check_H_C1")
                            .Label("C1 - PREMI REASURANSI KELUAR TTY")
                        )
                    </div>

                    <!-- BARIS 2 (A2 | B2 | C2) -->
                    <!-- A2 -->
                    <div style="width: 32%;">
                        @(Html.Kendo().CheckBox()
                            .Name("Check_H_A2")
                            .Label("A2 - KLAIM KOASURANSI MASUK")
                        )
                    </div>

                    <!-- B2 -->
                    <div style="width: 32%;">
                        @(Html.Kendo().CheckBox()
                            .Name("Check_H_B2")
                            .Label("B2 - KLAIM REASURANSI MASUK NON TTY")
                        )
                    </div>

                    <!-- C2 -->
                    <div style="width: 32%;">
                        @(Html.Kendo().CheckBox()
                            .Name("Check_H_C2")
                            .Label("C2 - PREMI REASURANSI KELUAR NON TTY")
                        )
                    </div>

                    <!-- BARIS 3 (A3) -->
                    <!-- A3 -->
                    <div style="width: 32%;">
                        @(Html.Kendo().CheckBox()
                            .Name("Check_H_A3")
                            .Label("A3 - PREMI KOASURANSI KELUAR")
                        )
                    </div>
                </div>
            </div>

        </div>

       <div class="filter-section" style="display: flex; align-items: center;">
            <label class="filter-label" for="JenisAsset">PRODUKSI :</label>

            @(Html.Kendo().DatePicker()
                .Name("tgl1")
                .Format("dd-MM-yyyy")
                .HtmlAttributes(new { style = "width:150px; margin-right: 5px;" }) )

            <label class="filter-label" for="JenisAssetSD">S/D :</label>

            @(Html.Kendo().DatePicker()
                .Name("tgl2")
                .Format("dd-MM-yyyy")
                .HtmlAttributes(new { style = "width:150px;" })
            )
        </div>

         <hr><label style="margin-top:10px">DATA PEMBAYARAN</label><hr>
        <div class="filter-section d-flex align-items-center">
            <label class="filter-label me-2" style="white-space: nowrap;">PELUNASAN S/D TGL :</label>

            @(Html.Kendo().DatePicker()
                .Name("tglpelunasan")
                .Format("dd-MM-yyyy")
                .HtmlAttributes(new { style = "width:150px" }) )
        </div>

       <div class="filter-section">
            <label class="filter-label">Jenis Laporan :</label>
            @(Html.Kendo().DropDownList()
                .Name("JenisLaporan")
                .DataTextField("Text")
                .DataValueField("Value")
                .BindTo(new List<SelectListItem>() {
                    new SelectListItem() { Text = "Detail (Keseluruhan)", Value = "Detail" },
                    new SelectListItem() { Text = "Per COB ", Value = "COB" },
                    new SelectListItem() { Text = "Per Tertanggung", Value = "Tertanggung" },
                    new SelectListItem() { Text = "Per Pembawa Pos", Value = "Pos" },
                    new SelectListItem() { Text = "Per Agen/Broker", Value = "Broker" }
                })
                .Value("Detail")
                .HtmlAttributes(new { style = "width:300px;" })
            )
        </div>

        <!-- Baris 4: Tombol Cari -->
        <div class="filter-section">
            @(Html.Kendo().Button()
                .Name("btnSearch")
                .Content("<span class='k-icon k-i-search'></span> Cari")
                .HtmlAttributes(new { @class = "k-primary", style = "border-radius:6px; width:120px;" })
                .Events(e => e.Click("onSearchClick"))
            )
        </div>

    </div>
</div>

<script>
    $(document).ready(function () {
        // Fungsi untuk mengontrol visibilitas
     function toggleCheckboxes() {
            var isPiutang = $('#JenisTransaksi_Piutang').is(':checked');
            var isHutang = $('#JenisTransaksi_Hutang').is(':checked');

            // Reset dulu keduanya ke hidden
            $('#checkboxContainerPiutang').hide();
            $('#checkboxContainerHutang').hide();

            // Cek kondisi
            if (isPiutang) {
                $('#checkboxContainerPiutang').show();
            } else if (isHutang) {
                $('#checkboxContainerHutang').show();
            }
            // Jika tidak ada yang checked, keduanya tetap hidden
        }
        // 1. Jalankan saat dokumen siap (untuk set awal)
        toggleCheckboxes();

        // 2. Jalankan saat salah satu radio button diubah
        $('input[name="JenisTransaksi"]').change(function() {
            toggleCheckboxes();
        });
    });
</script>